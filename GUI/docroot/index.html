<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="css/bootstrap.css">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="css/custom.css">
  <title>3CPickO</title>
</head>
<body>
  <div id="overlay"><div class="spinner-border text-primary overlay-spinner"></div></div>
  <nav>
    <div class="nav nav-tabs mb-2" id="nav-tab" role="tablist">
      <a class="nav-item nav-link" id="nav-start-tab" data-toggle="tab" href="#nav-start" role="tab" aria-controls="nav-start" aria-selected="false">Start</a>
      <a class="nav-item nav-link active" id="nav-new-job-tab" data-toggle="tab" href="#nav-new-job" role="tab" aria-controls="nav-new-job" aria-selected="true">New Job</a>
      <a class="nav-item nav-link" id="nav-all-jobs-tab" data-toggle="tab" href="#nav-all-jobs" role="tab" aria-controls="nav-all-jobs" aria-selected="false">All Jobs</a>
      <a class="nav-item nav-link" id="nav-historic-jobs-tab" data-toggle="tab" href="#nav-historic-jobs" role="tab" aria-controls="nav-all-jobs" aria-selected="false">History</a>
      <a class="nav-item nav-link" id="nav-settings-tab" data-toggle="tab" href="#nav-settings" role="tab" aria-controls="nav-settings" aria-selected="false">Settings</a>
      <a class="nav-item nav-link" id="nav-admin-tab" data-toggle="tab" href="#nav-admin" role="tab" aria-controls="nav-settings" aria-selected="false">Admin</a>
      <!-- inserted Wiki -->
      <a class="nav-item nav-link" id="nav-wiki-tab" data-toggle="tab" href="#nav-wiki" role="tab" aria-controls="nav-settings" aria-selected="false">Wiki</a>
      <!-- /inserted Wiki -->
    </div>
  </nav>
  <div class="tab-content" id="nav-tabContent">
    <div class="tab-pane fade" id="nav-start" role="tabpanel" aria-labelledby="nav-start-tab">
      <div class="container justify-content-start">
        <div class="row ">
          <div class="col-lg-8">
            <h1>Intro &hellip;</h1>
          </div>
        </div>
      </div>
    </div>
    <div class="tab-pane fade show active" id="nav-new-job" role="tabpanel" aria-labelledby="nav-new-job-tab">
      <div class="container-fluid">
        <div class="row">
          <div class="col-auto pr-0">
            <div class="nav flex-column nav-pills mb-2" id="steps">
              <h4 id="headertag">Entwurf</h4>
              <div class="nav-link active" id="browse-tab" href="#browse">1. Choose Image</div>
              <div class="nav-link" id="attributes-tab" href="#attributes">2. Set Attributes</div>
              <div class="nav-link" id="selection-tab" href="#selection">3. Detect Colonies</div>
              <div class="nav-link" id="strategy-tab" href="#strategy">4. Choose Plates</div>
              <div class="nav-link" id="overview-tab" href="#overview">5. Overview</div>
              <!-- <div class="nav-link" id="execute-tab" href="#execute">7. Start Picking</div> -->
            </div>
          </div>
          <div class="col p-0">
            <div class="tab-content mb-2" id="tabContent">
              <div class="tab-pane fade show active col" id="browse">
                <div class="row mb-4">
                  <div class="col-md-6 col-lg-4" style="min-width: 400px;">
                    <h2>Choose Image</h2>
                    <h6 id="img-name"></h6>
                    <form><input id="classicUpload" type="file" style="display: none;"></form>
                    <div id="dropZone" class="empty"></div>
                    <div id="chosen-image" style="display: none;">
                      <div id="selectedimage-description" class="float-left"></div>
                      <button id="continue-1" class="btn btn-success next-step float-right mt-1" onclick="attributesTab()">Continue</button>
                    </div>
                  </div>
                </div>
                <hr>
                <div class="row">
                  <div class="col">
                    <div id="all-images" style="display: none;"></div>
                  </div>
                </div>
              </div>
              <div class="tab-pane fade col-md-6 col-xl-4" id="attributes">
                <h2>Pickjob Attributes</h2>
                <form id="attributes-form" name="attributes-form" action="javascript:void(0);">
                  <div class="form-group">
                    <label for="staticImgName">Image:</label><span id="staticImgName"></span>
                  </div>
                  <div class="form-group">
                    <label for="date-attribute">Date:</label><span id="date-attribute"></span>
                  </div>
                  <div class="form-group">
                    <label for="inputJobName">Job name</label>
                    <input type="text" class="form-control" id="inputJobName" placeholder="optional">
                  </div>
                  <!-- Achtung Profi-Code -->
                  <div class="form-row" style="display: none;">
                    <div class="form-group col-md-6">
                      <label for="select-printer-profile">Printer-Profile</label>
                      <select class="form-control" id="select-printer-profile"></select>
                    </div>
                    <div class="form-group col-md-6" style="display: none;">
                      <label for="select-socket-profile">Socket-Profile</label>
                      <select class="form-control" id="select-socket-profile"></select>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="description-input">Description</label>
                    <textarea class="form-control" id="description-input" rows="5" placeholder="optional"></textarea>
                  </div>
                </form>
                <button id="enter-selection-button" class="btn btn-success next-step" onclick="selectionTab()">Continue</button>
              </div>
              <div class="tab-pane col-12 fade" id="selection">
                <div class="row">
                  <div id="colony-layers">
                    <h2>Selected Colonies: <span id="detected-colonies-number" class="text-primary">0</span>
                    </h2>
                    <div id="layer_parent">
                      <div class="btn-toolbar" id="layer-control">
                        <h4 class="mr-2">Toggle Layers:</h4>
                        <div class="btn-group btn-group-toggle mr-2" data-toggle="buttons">
                          <label id="show-selected-button" class="btn btn-secondary active"><input type="checkbox" id="show-selected" autocomplete="off" checked>Selected</label>
                          <label class="btn btn-secondary"><input type="checkbox" id="show-excluded" autocomplete="off">Excluded</label>
                        </div>
                        <div class="btn-group btn-group-toggle" data-toggle="buttons">
                          <label id="x-ray-button" class="btn btn-secondary"><input type="checkbox" id="x-ray" autocomplete="off" checked>X-Ray&trade;</label>
                        </div>
                        
                      </div>
                      <canvas id="layer0" style="z-index: 0;"></canvas> <!-- For colony image -->
                      <canvas id="layer1" style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas> <!-- For colony circles -->
                      <canvas id="layer2" style="position: absolute; left: 0; top: 0; z-index: 2;"></canvas> <!-- For tooltips -->
                      <canvas id="layer3" style="position: absolute; left: 0; top: 0; z-index: 3;"></canvas> <!-- For safety-margin -->
                    </div>
                    <div id="buttons">
                      <button id="strategy-tab-button" class="btn btn-success next-step mt-1" onclick="strategyTab()" disabled>Continue</button>
                    </div>
                    <div id="showCoordinates"></div>
                  </div>
                  <div id="detection-settings-div">
                    <h2>Detection Settings</h2>
                    <div class="form-group">
                      <label>Algorithm:</label>
                      <select class="form-control" id="select-algorithm" name="select-algorithm"></select>
                    </div>
                    <div id="detection-settings"></div>
                  </div>
                </div>
              </div>
              <div class="tab-pane fade col" id="strategy">
                <div class="row">
                  <div class="col-md-4 col-lg-2" style="min-width: 300px;">
                    <h2>Choose Goal Plate</h2>
                    <form id="strategy-form" action="javascript:void(0);">
                      <div class="form-group">
                        <label for="select-plate-profile">Goal Plate:</label>
                        <select class="form-control" id="select-plate-profile"></select>
                      </div>
                      <div id="number-of-colonies-slider"></div>
                      <small id="number-of-colonies-warning" class="form-text text-muted mb-2" style="display: none;"><span class="text-danger">Note: Colonies will be chosen randomly.</span></small>
                    </form>
                    <button id="enter-overview-button" class="btn btn-success next-step">Continue</button>
                  </div>
                  <div class="col">
                    <h2>Choose Starting Well</h2>
                    <canvas id="pickstrategy-canvas"></canvas>
                    <br>
                  </div>
                </div>
              </div>
              <div class="tab-pane fade col-xl-10" id="overview">
                <h2>Overview</h2>
                <div class="row">
                  <div class="col-md-8">
                    <div id="overview-image" style="position: relative;">
                      <img id="processed-layer0" width="100%" style="z-index: 0;">
                      <img id="processed-layer1" width="100%" style="position: absolute; left: 0; top: 0; z-index: 1;">
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div id="overview-metadata"></div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-8">
                    <form id="check-preconditions" class="needs-validation" novalidate>
                      <div class="form-group">
                        <div class="custom-control custom-checkbox">
                          <input class="custom-control-input" type="checkbox" value="" id="check-plates" required>
                          <label class="custom-control-label" for="check-plates">
                            Plates correctly positioned in colony picker?
                          </label>
                          <div class="invalid-feedback">
                            Check plates and confirm!
                          </div>
                        </div>
                        <div class="custom-control custom-checkbox">
                          <input class="custom-control-input" type="checkbox" value="" id="invalidCheck" required>
                          <label class="custom-control-label" for="invalidCheck">
                            Agree to terms and conditions.
                          </label>
                          <div class="invalid-feedback">
                            You must agree!
                          </div>
                        </div>
                      </div>
                    </form>
                    <button class="btn btn-success m-2" id="execute-button" onclick="executeTab()">Start picking</button>
                    <button class="btn btn-success m-2" id="pickjob-running" disabled style="display: none">Picking in process <span class="spinner-border spinner-border-sm"></span></button>
                  </div>
                </div>
              </div>
              <div class="tab-pane fade col-md-8" id="execute">
                <!-- TODO Pickjob pausieren/abbrechen, Protokoll herunterladen -->
                <h1>Picking...</h1>
                <div class="spinner-border"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="tab-pane fade" id="nav-all-jobs" role="tabpanel" aria-labelledby="nav-all-jobs-tab">
      <div class="container">
        <h1>Pickjobs</h1>
        <form class="form-inline">
          <input class="form-control my-2 mr-2" type="search" placeholder="Suchbegriff">
          <button class="btn btn-primary my-2" type="submit">Filter</button>
        </form>
        <div id="allJobList"></div>
      </div>
    </div>
    <div class="tab-pane fade" id="nav-historic-jobs" role="tabpanel" aria-labelledby="nav-historic-jobs-tab">
      <div class="container">
        <h1>Job History</h1>
      </div>
    </div>
    <div class="tab-pane fade" id="nav-settings" role="tabpanel" aria-labelledby="nav-settings-tab">
      <div class="container-fluid">
        <div class="row mb-2" id="group">
          <div class="col-md-6 col-xl-3">
            <h2>Octoprint Profiles</h2>
            <div class="accordion" id="octoprint-profiles"></div>
          </div>
          <div class="col-md-6 col-xl-3">
            <h2>Printer Profiles</h2>
            <div class="accordion" id="printer-profiles"></div>
          </div>
          <div class="col-md-6 col-xl-3">
            <h2>Socket Profiles</h2>
            <div class="accordion" id="socket-profiles"></div>
          </div>
          <div class="col-md-6 col-xl-3">
            <h2>Plate Profiles</h2>
            <div class="accordion" id="plate-profiles"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="tab-pane fade" id="nav-admin" role="tabpanel" aria-labelledby="nav-admin-tab">
      <button type="button" class="btn btn-danger" onclick="api('shutdown')">Server ausschalten</button>
      <button type="button" class="btn btn-danger" onclick="api('restart')">Server neustarten</button>
      <button type="button" class="btn btn-success" onclick="api('backup')">Backup</button>
      <button type="button" class="btn btn-success" onclick="api('startjob')">Drucken</button>
      <div id="debug-output"></div>
    </div>
    <!-- inserted Wiki -->
    <div class="tab-pane fade" id="nav-wiki" role="tabpanel" aria-labelledby="nav-wiki-tab">
     <div class="container-fluid">
      <div class="row">
        <div class="col-auto">
         <h4 id="headertag">Wiki</h4>
         <div class="row">
           <button class="btn btn-default m-1" id="Introduction" onclick="loadWiki('./docs/Introduction.html')">Introduction</button>
         </div>
         <h5 id="headertag">User Manual</h5>
         <div class="row">
           <button class="btn btn-default m-1" id="User-Manual-First-Steps" onclick="loadWiki('./docs/User-Manual-First-Steps.html')">First Steps</button>
         </div>
         <div class="row">
           <button class="btn btn-default m-1" id="User-Manual-Example-Picking-Process" onclick="loadWiki('./docs/User-Manual-Example-Picking-Process.html')">Example Picking Process</button>
         </div>
         <div class="row">
          <button class="btn btn-default m-1" id="User-Manual-Advanced-Settings" onclick="loadWiki('./docs/User-Manual-Advanced-Settings.html')">Advanced Settings</button>
        </div>
        <h5 id="headertag">Configuration</h5>
        <div class="row">
         <button class="btn btn-default m-1" id="Configuration-Hardware" onclick="loadWiki('./docs/Configuration-Hardware.html')">Hardware</button>
       </div>
       <div class="row">
         <button class="btn btn-default m-1" id="Configuration-Software" onclick="loadWiki('./docs/Configuration-Software.html')">Software</button>
       </div>
       <h5 id="headertag">Administration</h5>
       <div class="row">
         <button class="btn btn-default m-1" id="Administration-Hardware" onclick="loadWiki('./docs/Administration-Hardware.html')">Hardware</button>
       </div>
       <div class="row">
         <button class="btn btn-default m-1" id="Administration-Software" onclick="loadWiki('./docs/Administration-Software.html')">Software</button>
       </div>
     </div>
     <div class="col-5">
      <p id="wiki-content">Error: Page not found</p>
    </div>
  </div>
</div>
</div>
<!-- /inserted Wiki -->
</div>

<!-- Info-Dialog -->
<div class="modal fade" id="info-dialog" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="info-dialog-title"></h5>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Ok</button>
      </div>
    </div>
  </div>
</div>
<!-- Delete-Dialog -->
<div class="modal fade" id="delete-dialog" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="delete-dialog-title"></h5>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <!-- <div class="modal-body" id="delete-dialog-body"></div> -->
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-danger" data-dismiss="modal" id="delete-button">Delete</button>
      </div>
    </div>
  </div>
</div>
<!-- Global Alert: call ShowAlert(message, type) -->
<div id="alert-window">
  <div id="global-alert" style="display: none;">Disconnected from server.</div>
</div>
<!-- inserted Wiki -->
<!-- change aria-labelledby -->
<div class="modal fade" id="colony-detection-help" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="help-headline">Error: Headline not found</h5>
      </div>
      <div class="modal-body">
        <p id="help-body">Error: Help not found </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- /inserted Wiki -->

<!-- Optional JavaScript -->
<!-- jQuery first, then Bootstrap JS -->
<script src="js/jquery-3.3.1.js"></script>
<script src="js/bootstrap.bundle.js"></script>
<script type="text/javascript" src="js/multirange.js"></script>
<script type="text/javascript" src="js/formgroup.js"></script>
<script type="text/javascript" src="js/dropzone.js"></script>
<script type="text/javascript" src="js/colonydetection.js"></script>
<script type="text/javascript" src="js/pickstrategie.js"></script>
<script type="text/javascript" src="js/circle.js"></script>
<script type="text/javascript" src="js/api.js"></script>
<script type="text/javascript" src="js/config.js"></script>
<script type="text/javascript" src="js/index.js"></script>
<!-- /inserted Wiki -->
<script type="text/javascript" src="js/wiki.js"></script>
<!-- /inserted Wiki -->
</body>
</html>
